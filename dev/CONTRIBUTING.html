<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Contributing to duckplyr • duckplyr</title><!-- favicons --><link rel="icon" type="image/png" sizes="48x48" href="favicon-48x48.png"><link rel="icon" type="”image/svg+xml”" href="favicon.svg"><link rel="apple-touch-icon" sizes="180x180" href="apple-touch-icon.png"><link rel="icon" sizes="any" href="favicon.ico"><link rel="manifest" href="site.webmanifest"><script src="deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="deps/Source_Sans_Pro-0.4.9/font.css" rel="stylesheet"><link href="deps/Source_Code_Pro-0.4.9/font.css" rel="stylesheet"><link href="deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="deps/headroom-0.11.0/headroom.min.js"></script><script src="deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="deps/search-1.0.0/fuse.min.js"></script><script src="deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="pkgdown.js"></script><meta property="og:title" content="Contributing to duckplyr"><meta property="og:image" content="https://duckplyr.tidyverse.org/logo.png"><meta name="robots" content="noindex"><script defer data-domain="duckplyr.tidyverse.org,all.tidyverse.org" src="https://plausible.io/js/plausible.js"></script></head><body>
    <a href="#container" class="visually-hidden-focusable">Skip to content</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-none" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="index.html">duckplyr</a>

    <small class="nav-text text-danger me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="In-development version">0.99.99.9918</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="articles/developers.html">Use of duckplyr in other packages</a></li>
    <li><a class="dropdown-item" href="articles/limits.html">Translations</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/tidyverse/duckplyr/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-title-body" id="container">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="logo.png" class="logo" alt=""><h1>Contributing to duckplyr</h1>
      <small class="dont-index">Source: <a href="https://github.com/tidyverse/duckplyr/blob/main/.github/CONTRIBUTING.md" class="external-link"><code>.github/CONTRIBUTING.md</code></a></small>
    </div>

<div id="contributing-to-duckplyr" class="section level1">

<p>This outlines how to propose a change to duckplyr. For a detailed discussion on contributing to this and other tidyverse packages, please see the <a href="https://rstd.io/tidy-contrib" class="external-link">development contributing guide</a> and our <a href="https://code-review.tidyverse.org/" class="external-link">code review principles</a>.</p>
<div class="section level2">
<h2 id="fixing-typos">Fixing typos<a class="anchor" aria-label="anchor" href="#fixing-typos"></a></h2>
<p>You can fix typos, spelling mistakes, or grammatical errors in the documentation directly using the GitHub web interface, as long as the changes are made in the <em>source</em> file. This generally means you’ll need to edit <a href="https://roxygen2.r-lib.org/articles/roxygen2.html" class="external-link">roxygen2 comments</a> in an <code>.R</code>, not a <code>.Rd</code> file. You can find the <code>.R</code> file that generates the <code>.Rd</code> by reading the comment in the first line.</p>
</div>
<div class="section level2">
<h2 id="bigger-changes">Bigger changes<a class="anchor" aria-label="anchor" href="#bigger-changes"></a></h2>
<p>If you want to make a bigger change, it’s a good idea to first file an issue and make sure someone from the team agrees that it’s needed. If you’ve found a bug, please file an issue that illustrates the bug with a minimal <a href="https://www.tidyverse.org/help/#reprex" class="external-link">reprex</a> (this will also help you write a unit test, if needed). See our guide on <a href="https://code-review.tidyverse.org/issues/" class="external-link">how to create a great issue</a> for more advice.</p>
<div class="section level3">
<h3 id="pull-request-process">Pull request process<a class="anchor" aria-label="anchor" href="#pull-request-process"></a></h3>
<ul><li><p>Fork the package and clone onto your computer. If you haven’t done this before, we recommend using <code>usethis::create_from_github("tidyverse/duckplyr", fork = TRUE)</code>.</p></li>
<li><p>Install all development dependencies with <code>devtools::install_dev_deps()</code>, and then make sure the package passes R CMD check by running <code>devtools::check()</code>. If R CMD check doesn’t pass cleanly, it’s a good idea to ask for help before continuing.</p></li>
<li><p>Create a Git branch for your pull request (PR). We recommend using <code>usethis::pr_init("brief-description-of-change")</code>.</p></li>
<li><p>Make your changes, commit to git, and then create a PR by running <code><a href="https://usethis.r-lib.org/reference/pull-requests.html" class="external-link">usethis::pr_push()</a></code>, and following the prompts in your browser. The title of your PR should briefly describe the change. The body of your PR should contain <code>Fixes #issue-number</code>.</p></li>
<li><p>Please do not edit <code>NEWS.md</code>.</p></li>
</ul></div>
<div class="section level3">
<h3 id="code-style">Code style<a class="anchor" aria-label="anchor" href="#code-style"></a></h3>
<ul><li><p>New code should follow the tidyverse <a href="https://style.tidyverse.org" class="external-link">style guide</a>. You can use the <a href="https://CRAN.R-project.org/package=styler" class="external-link">styler</a> package to apply these styles, but please don’t restyle code that has nothing to do with your PR.</p></li>
<li><p>We use <a href="https://cran.r-project.org/package=roxygen2" class="external-link">roxygen2</a>, with <a href="https://cran.r-project.org/web/packages/roxygen2/vignettes/rd-formatting.html" class="external-link">Markdown syntax</a>, for documentation.</p></li>
<li><p>We use <a href="https://cran.r-project.org/package=testthat" class="external-link">testthat</a> for unit tests. Contributions with test cases included are easier to accept.</p></li>
</ul></div>
</div>
<div class="section level2">
<h2 id="new-translations-for-functions">New translations for functions<a class="anchor" aria-label="anchor" href="#new-translations-for-functions"></a></h2>
<p>For all functions used in dplyr verbs, translations must be provided. The code lives in <code>translate.R</code> . New translations must change code in two places:</p>
<ol style="list-style-type: decimal"><li><p>The <code><a href="https://rdrr.io/r/base/switch.html" class="external-link">switch()</a></code> in <code>rel_find_call()</code> needs a new entry, together with the package that is home to the function. The top 60 functions, ranked by importance, are already part of that <code><a href="https://rdrr.io/r/base/switch.html" class="external-link">switch()</a></code>, as a comment if they are not implemented yet.</p></li>
<li><p>The actual translation must be implemented in <code>rel_translate_lang()</code>. This is easy for some functions that have similar functions that are already translated, but harder for others. This part of the code is not very clear yet, in particular, argument matching by name is only available for a few functions but should be generalized.</p></li>
<li>
<p>Test your implementation in the console with code of the form:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">rel_translate</span><span class="op">(</span><span class="fu"><a href="https://rlang.r-lib.org/reference/defusing-advanced.html" class="external-link">quo</a></span><span class="op">(</span><span class="va">a</span> <span class="op">+</span> <span class="fl">1</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>a <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">constructive</span><span class="fu">::</span><span class="fu"><a href="https://cynkra.github.io/constructive/reference/construct.html" class="external-link">construct</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
</li>
<li><p>Add a test for the new translation to the <code>mutate =</code> section of <code>test_extra_arg_map</code> in <code>00-funs.R</code>. (At some point we want to have more specific tests for the translations, for now, this is what it is.)</p></li>
<li><p>Run <code>03-tests.R</code>, commit the changes to the generated code to version control.</p></li>
<li><p>Update the list in the <code>limits.Rmd</code> vignette.</p></li>
</ol></div>
<div class="section level2">
<h2 id="support-more-options-for-verbs">Support more options for verbs<a class="anchor" aria-label="anchor" href="#support-more-options-for-verbs"></a></h2>
<p>All verbs wrap the code in a <code>rel_try({})</code> call and fall back to dplyr in the case of failure. The <code>rel_try()</code> function takes named arguments that describe conditions for an early drop-out, and the corresponding error message. To add support for a condition for which a drop-out is being defined, roughly the following steps are necessary:</p>
<ol style="list-style-type: decimal"><li>Remove the drop-out condition.</li>
<li>Run the tests, take note of the failures.</li>
<li>Provide an implementation that fixes the failures.</li>
<li>Add a test that the verb works with <code>DUCKPLYR_FORCE = TRUE</code> under the new conditions.</li>
<li>Run <code>02-duckplyr_df-methods.R</code> to update the corresponding patch file.</li>
</ol></div>
<div class="section level2">
<h2 id="support-new-verbs">Support new verbs<a class="anchor" aria-label="anchor" href="#support-new-verbs"></a></h2>
<p>Let’s discuss first!</p>
</div>
<div class="section level2">
<h2 id="support-new-column-data-types">Support new column data types<a class="anchor" aria-label="anchor" href="#support-new-column-data-types"></a></h2>
<p>Let’s discuss first!</p>
</div>
<div class="section level2">
<h2 id="support-new-data-frame-types">Support new data frame types<a class="anchor" aria-label="anchor" href="#support-new-data-frame-types"></a></h2>
<p>Let’s discuss first!</p>
</div>
<div class="section level2">
<h2 id="code-generation-and-synchronization">Code generation and synchronization<a class="anchor" aria-label="anchor" href="#code-generation-and-synchronization"></a></h2>
<p>The duckplyr package is a “long-running fork of dplyr”, and has code to generate parts of its own implementation and tests, and to synchronize changes from duckplyr with our codebase. The main synchronization script is <code>tools/99-sync.R</code>, it also contains instructions how to set up a new clone. This script should be run whenever the implementation of the verbs changes in a substantial way. Watch out for the <code># Generated by ...</code> headers at the top of source files.</p>
</div>
<div class="section level2">
<h2 id="code-of-conduct">Code of Conduct<a class="anchor" aria-label="anchor" href="#code-of-conduct"></a></h2>
<p>Please note that the duckplyr project is released with a <a href="CODE_OF_CONDUCT.html">Contributor Code of Conduct</a>. By contributing to this project you agree to abide by its terms.</p>
</div>
</div>

  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


   </div>
  <footer><div class="container">
  <div class="pkgdown-footer-left">
  <p>Developed by <a href="https://hannes.muehleisen.org/" class="external-link">Hannes Mühleisen</a>, <a href="https://krlmlr.info" class="external-link">Kirill Müller</a>, <a href="https://www.posit.co" class="external-link"><img src="https://www.tidyverse.org/posit-logo.svg" alt="Posit" height="16" width="62" style="margin-bottom: 3px;"></a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.9000.</p>
</div>

  </div></footer></body></html>

